<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>S0LACE â€¢ Stats</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" href="index.css">
  <script src="global-hub.js" defer></script>
</head>

<body>

<nav class="side-header">
  <a href="index.html" class="side-icon" data-icon="home"><img></a>
  <a href="games.html" class="side-icon" data-icon="games"><img></a>
  <a href="media.html" class="side-icon" data-icon="media"><img></a>
  <a href="settings.html" class="side-icon" data-icon="settings"><img></a>
</nav>

<main style="padding:40px; max-width:900px; margin:auto">
  <h1>Traffic Stats</h1>

  <h2>Countries</h2>
  <ul id="countries"></ul>

  <h2>Regions</h2>
  <ul id="regions"></ul>
</main>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, get } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const app = initializeApp({
  apiKey: "AIzaSyBbgy76ThxHaKlOhpiLQ6Nw4ekR1b9t3DA",
  databaseURL: "https://s0lace-web-default-rtdb.firebaseio.com"
});
const db = getDatabase(app);

async function loadList(path, el) {
  const snap = await get(ref(db, path));
  const data = snap.val() || {};

  el.innerHTML = "";
  Object.entries(data)
    .sort((a,b)=>b[1]-a[1])
    .forEach(([k,v])=>{
      const li = document.createElement("li");
      li.textContent = `${k}: ${v}`;
      el.appendChild(li);
    });
}

loadList("geo/countries", document.getElementById("countries"));
loadList("geo/regions", document.getElementById("regions"));
</script>

<script>
/* side icon sync */
function getAccent() {
  return localStorage.getItem("s0laceAccent") || "gray";
}
document.querySelectorAll(".side-icon").forEach(a=>{
  const img=a.querySelector("img");
  const icon=a.dataset.icon;
  const active=location.pathname.endsWith(a.getAttribute("href"));
  img.src=`thumbs/${icon}/${active?getAccent():"gray"}.png`;
});
</script>

  <script>
document.getElementById("countries").innerHTML = "<li>TEST: script is running</li>";
document.getElementById("regions").innerHTML = "<li>TEST: script is running</li>";
</script>


</body>
</html>
